import java.util.Arrays;
import java.util.concurrent.atomic.AtomicInteger;

public class HttpEndpointRouter {
    private static String[] backendServers;
    private static AtomicInteger count = new AtomicInteger(0);

    static {
        String urls = System.getProperty("proxyServer",
            "http://localhost:8801,http://localhost:8802");
        backendServers = Arrays.stream(urls.split(",")).map(String::trim).toArray(String[]::new);
    }

    //round robin
    public static String getServer() {
        if (count.get() > 1000000) {
            count = new AtomicInteger(0);
        }
        return backendServers[count.incrementAndGet() % backendServers.length];
    }
}
